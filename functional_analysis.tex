\documentclass{article}

% preamble
\def\npart{III}
\def\nyear{2023}
\def\nterm{Michaelmas}
\def\nlecturer{Dr Andr\'as Zs\'ak}
\def\ncourse{Functional Analysis}
\def\draft{Incomplete}

\input{header}
\swapnumbers
\reversemarginpar

\usetikzlibrary{positioning, decorations.pathmorphing, decorations.text, calc, backgrounds, fadings}
\tikzset{node/.style = {circle,draw,inner sep=0.8mm}}

\makeindex[intoc]

\setcounter{section}{-1}

% and here we go!
\begin{document}
\maketitle

\tableofcontents

\clearpage

\section{Introduction}

\subsection*{Prerequisites}

\begin{itemize}
  \item some basic functional analysis
  \item a bit of measure theory
  \item a bit of complex analysis
\end{itemize}

\subsection*{Books}

Books relevant to the course are:
\begin{itemize}
  \item Bollob\'as, \textit{Linear Analysis}
  \item Murphy, \textit{$C^*$-algebras}
  \item Rudin
  \item Graham-Allan
\end{itemize}

\subsection*{Notation}

We will use $\K$ to mean "either $\R$ or $\C$".

For $X$ a normed space, we define
\begin{eqnarray*}
  B_X & = & \{x \in X | \norm x \le 1\} \\
  S_X & = & \{x \in X | \norm x = 1\} \\
  D_X & = & \{x \in X | \norm x < 1\}
\end{eqnarray*}

For $X, Y$ normed spaces, we write $X \sim Y$ if $X, Y$ are isomorphic, ie there
exists a linear bijection $T : X \mor Y$ such that $T$ and $T^{-1}$ are continuous. We write $X \cong Y$ if $X, Y$ are isometrically isomorphic, ie there exists a surjective linear map $T : X \mor Y$ such that $\norm{T x} = \norm x$ for all $x$.

\clearpage

\section{Hahn-Banach extension theorems}

\newlec

Let $X$ be a normed space. The {\bf dual space} of $X$ is the space $X^*$ of
bounded linear functionals on $X$.
$X^*$ is always a Banach space in the operator norm: for $f \in X^*$,
$$\norm f = \sup_{x \in B_X} |f(x)|$$

\begin{eg}
  For $1 < p, q < \infty$, $p^{-1} + q^{-1} = 1$, $\ell_p^* \cong \ell_q$. \\
  We also have $\ell_1^* \cong \ell_\infty$, $c_0^* \cong \ell_1$. \\
  If $H$ is a Hilbert space, then $H^* \cong H$ (the isomorphism is conjugate-linear in the complex case).
\end{eg}

For $x \in X, f \in X^*$, we write $\inn x f = f(x)$. Note that
$$\inn x f = |f(x)| \le \norm f\norm x$$

\begin{defi}
  Let $X$ be a {\it real} vector space. A functional $p : X \mor \R$ is
  \begin{itemize}
    \item {\bf positive homogeneous} if $p(tx) = tp(x)$ for all $x \in X$, $t \ge 0$
    \item {\bf subadditive} if $p(x + y) \le p(x) + p(y)$ for all $x, y \in X$
  \end{itemize}
\end{defi}

\begin{defi}
  Let $P$ be a preorder, $A \subseteq P, x \in P$. We say
  \begin{itemize}
    \item $x$ is an {\bf upper bound} for $A$ if $\for a \in A, a \le x$.
    \item $A$ is a {\bf chain} if $\for a, b \in A, a \le b \lor b \le a$.
    \item $x$ is a {\bf maximal element} if $\for y \in P, x \not < y$
  \end{itemize}
\end{defi}

\begin{fact}[Zorn's lemma]
  A nonempty preorder in which all nonempty chains have an upper bound has a maximal element.
\end{fact}

\begin{thm}[Hahn-Banach, positive homogeneous version]\label{thm:hb-positive}
  Let $X$ be a real vector space and $p : X \mor \R$ be positive homogeneous and subadditive. Let $Y$ be a subspace of $X$ and $g : Y \mor \R$ be linear such that $\for y \in Y, g(y) \le p(y)$. Then there exists $f : X \mor \R$ linear such that $f\restriction_Y = g$ and $\for x \in X, f(x) \le p(x)$.
\end{thm}
\begin{proof}
  Let $P$ be the set of pairs $(Z, h)$ where $Z$ is a subspace of $X$ with $Y \subseteq Z$ and $h : Z \mor \R$ linear, $h\restriction_Y = g$ and $\for z \in Z, h(z) \le p(z)$. $P$ is nonempty since $(Y, g) \in P$, and is partially ordered by
  $$(Z_1, h_1) \le (Z_2, h_2) \iff Z_1 \subseteq Z_2 \land h_2\restriction_{Z_1} = h_1$$
  If $\{(Z_i, h_i) | i \in I\}$ is a chain with $I$ nonempty, then we can define
  $$Z := \bigcup_{i \in I} Z_i, h\restriction_{Z_i} = h_i$$
  The definition of $h$ makes sense thanks to the chain assumption. $(Z, h) \in P$ is therefore an upper bound for the chain. \\
  Hence find by Zorn a maximal element $(Z, h)$ of $P$. If $Z = X$, we won. So assume there is some $x \in X \ Z$. Let $W = \Span(Z \cup \{x\})$ and define $f : W \mor \R$ by
  $$f(z + \lambda x) = h(z) + \lambda\alpha$$
  for some $\alpha \in \R$. Then $f$ is linear and $f\restriction_Z = h$. We now look for $\alpha$ such that $\for w \in W, f(w) \le p(w)$. We would then have $(W, f) \in P$ and $(Z, h) < (W, f)$, contradicting maximality of $(Z, h)$. \\
  We need
  $$h(z) + \lambda\alpha \le p(z + \lambda x) \for z \in Z, \lambda \in \R$$
  Since $p$ is positive homogeneous, this becomes
  \begin{align}
    h(z) + \alpha \le p(z + x)
    h(z) - \alpha \le p(z - x)
  \end{align}
  ie
  $$h(z) - p(z - x) \le \alpha \le p(z + x) - h(z) \for z \in Z$$
  The existence of $\alpha$ now amounts to
  $$h(z_1) - p(z_1 - x) \le \alpha \le p(z_2 + x) - h(z_2) \for z_1, z_2 \in Z$$
  But indeed
  $$h(z_1) + h(z_2) = h(z_1 + z_2) \le p(z_1 + z_2) \le p(z_1 - x) + p(z_2 + x)$$
\end{proof}

\begin{defi}
  Let $X$ be a $\K$-vector space. A {\bf seminorm} on $X$ is a functional $p : X \mor \R$ such that
  \begin{itemize}
    \item $\for x \in X, p(x) \ge 0$
    \item $\for x \in X, \lambda \in \K, p(\lambda x) = |\lambda| p(x)$
    \item $\for x, y \in X, p(x + y) \le p(x) + p(y)$
  \end{itemize}
\end{defi}

\begin{rmk}
  $$\text{norm} \implies \text{seminorm} \implies \text{positive homogeneous}$$
\end{rmk}

\newlec

\begin{thm}[Hahn-Banach, absolute homogeneous version]\label{thm:hb-absolute}
  Let $X$ be a real of complex vector space and $p$ a seminorm on $X$. Let $Y$ be a subspace of $X$, $g$ a linear functional on $Y$ such that $\for y \in Y, |g(y)| \le p(y)$. Then there exists a linear functional $f$ on $X$ such that $f\restriction_Y = g$ and $\for x \in X, |f(x)| \le p(x)$.
\end{thm}
\begin{proof}~\\
  {\bf Real case}
  $$\for y \in Y, g(y) \le |g(y)| \le p(y)$$
  By Theorem \ref{thm:hb-positive}, there exists $f : X \mor \R$ such that $f\restriction_Y = g$ and $\for x \in X, f(x) \le p(x)$. We also have
  $$\for x \in X, -f(x) = f(-x) \le p(-x) = p(x)$$
  Hence $|f(x)| \le p(x)$ \\
  {\bf Complex case} \\
  $\Re g : Y \mor \R$ is real-linear.
  $$\for y \in Y, |\Re g(y)| \le |g(y)| \le p(y)$$
  By the real case, find $h : X \mor \R$ real-linear such that $h\restriction_Y = \Re g$
  \begin{claim}
    There exists a unique complex-linear $f : X \mor \C$ such that $h = \Re f$.
  \end{claim}
  \begin{proof}~\\
    {\bf Uniqueness} \\
    If we have such $f$, then
    \begin{eqnarray*}
      f(x)
      & = & \Re f(x) + i\Im f(x) \\
      & = & \Re f(x) - i\Re f(ix) \\
      & = & h(x) - ih(ix)
    \end{eqnarray*}
    {\bf Existence} \\
    Define $f(x) = h(x) - ih(ix)$. Then $f$ is real-linear and $f(ix) = if(x)$, so $f$ is complex-linear with $\Re f = h$.
  \end{proof}
  We now have $f : X \mor \C$ such that $\Re f = h$.
  $$\Re f\restriction_Y = h\restriction_Y = \Re g$$
  So, by uniqueness, $f\restriction_Y = g$. \\
  Given $x \in X$, find $\lambda$ with $|\lambda| = 1$ such that
  \begin{eqnarray*}
    |f(x)|
    & = & \lambda f(x) \\
    & = & f(\lambda x) \\
    & = & \Re f(\lambda x) \\
    & = & h(\lambda x) \\
    & \le & p(\lambda x) \\
    & = & p(x)
  \end{eqnarray*}
\end{proof}

\begin{rmk}
  For a complex vector space $X$, if we write $X_\R$ for $X$ considered as a real vector space, the above proof shows that
  $$\Re : (X^*)_\R \mor X_\R^*$$
  is an isometric isomorphism.
\end{rmk}

\begin{cor}\label{cor:hb-point}
  Let $X$ be a $\K$-vector space, $p$ a seminorm on $X$, $x_0 \in X$. Then there exists a linear functional $f$ on $X$ such that $f(x_0) = p(x_0)$ and $\for x \in X, |f(x)| \le p(x)$.
\end{cor}
\begin{proof}
  Let $Y = \Span(x_0)$,
  \begin{eqnarray*}
    g : Y & \mor & \K \\
    \lambda x_0 & \mapsto & \lambda p(x_0)
  \end{eqnarray*}
  We see that $\for y \in Y, g(y) \le p(y)$. Hence find by Theorem \ref{thm:hb-absolute} a linear functional $f$ on $X$ such that $f\restriction_Y = g$ and $\for x \in X, |f(x)| \le p(x)$. We check that $f(x_0) = g(x_0) = p(x_0)$.
\end{proof}

\begin{thm}[Hahn-Banach, existence of support functionals]\label{thm:hb-support}
  Let $X$ be a real or complex normed space. Then
  \begin{enumerate}
    \item If $Y$ is a subspace of $X$ and $g \in Y^*$, then there exists $f \in X^*$ such that $f\restriction_Y = g$ and $\norm f = \norm g$.
    \item Given $x_0 \ne 0$, there exists $f \in S_{X^*}$ such that $f(x_0) = \norm{x_0}$.
  \end{enumerate}
\end{thm}
\begin{proof}~
  \begin{enumerate}
    \item Let $p(x) = \norm g \norm x$. Then $p$ is a seminorm on $X$ and
      $$\for y \in Y, |g(y)| \le \norm g \norm y = p(y)$$
      Find by Theorem \ref{thm:hb-positive} a linear functional $f$ on $X$ such that $f\restriction_Y = g$ and $\for x \in X, |f(x)| \le p(x) = \norm g \norm x$. So $\norm f \le \norm g$. Since $f\restriction_Y = g$, we also have $\norm g \le \norm f$. Hence $\norm f = \norm g$.
    \item Apply Corollary \ref{cor:hb-point} with $p(x) = \norm x$ to get $f \in X^*$ such that
      $$\for x \in X, |f(x)| \le \norm x \text{ and } f(x_0) = \norm{x_0}$$
      It follows that $\norm f = 1$.
  \end{enumerate}
\end{proof}

\begin{rmks}~
  \begin{itemize}
    \item Part 1 is a sort of linear version of Tietze's extension theorem: Given $K$ compact Hausdorff, $L \subseteq K$ closed, $g : L \mor \K$ continuous, there exists $f : K \mor \K$ such that $f\restriction_L = g$ and $\norm f_\infty = \norm g_\infty$.
    \item Part 2 shows that for all $x \ne y$ in $X$ there exists $f \in X^*$ such that $f(x) \ne f(y)$, namely $X^*$ {\bf separates points} of $X$. This is a sort of linear version of Urysohn: $C(K)$ separates points of $K$.
    \item The $f$ in part 2 is called a {\bf norming functional}, aka {\bf support functional}, for $x_0$. The existence of support functionals shows that
      $$x_0 = \max_{g \in B_{X^*}} \inn{x_0}g$$
      Assuming $X$ is a real normed space and $\norm{x_0} = 1$, we have $B_X \subseteq \{x \in X| f(x) \le 1\}$. Visually, TODO: insert tangency diagram
  \end{itemize}
\end{rmks}

\subsection{Bidual}

Let $X$ be a normed space. Then $X^{**}$ is called the {\bf bidual} or {\bf second dual} of $X$.

For $x \in X$, define $\hat x : X^* \mor \K$, the {\bf evaluation at $x$}, by $\hat x(f) = f(x)$. $\hat x$ is linear and $|\hat x(f)| = |f(x)| \le \norm f \norm x$, so $\hat x \in X^{**}$ and $\norm{\hat x} \le \norm x$.

The map $x \mapsto \hat x : X \mor X^{**}$ is called the {\bf canonical embedding} of $X$ into $X^{**}$.

\begin{thm}\label{thm:can-emb}
  The canonical embedding is an isometric embedding.
\end{thm}
\begin{proof}~\\
  {\bf Linearity}
  \begin{eqnarray*}
    \widehat{x + y}(f) & = & f(x + y) = f(x) + f(y) = \hat x(f) + \hat y(f) \\
    \widehat{\lambda x}(f) & = & f(\lambda x) = \lambda f(x) = \lambda \hat x(f)
  \end{eqnarray*}
  {\bf Isometry} \\
  If $x \ne 0$, there exists a support functional $f$ for $x$. Then
  $$ \norm{\hat x} \ge |\hat x(f)| = |f(x)| = \norm x$$
\end{proof}

\begin{rmks}~
  \begin{itemize}
    \item In bracket notation, $\inn f {\hat x} = \inn x f$
    \item Let $\hat X$ be the image of $X$ in $X^{**}$. Theorem \ref{thm:can-emb} says
      $$X \cong \hat X \subseteq X^{**}$$
      We often identify $\hat X$ with $X$ and think of $X$ as living isometrically inside $X^{**}$. Note that
      $$X \text{ complete } \iff \hat X \text{ closed in } X^{**}$$
    \item More generally, $\bar{\hat X}$ is a Banach space containing an isometric copy of $X$ as a dense subspace. We proved that normed spaces have completions!
  \end{itemize}
\end{rmks}

\begin{defi}
  A normed space $X$ is {\bf reflexive} if the canonical embedding $X \mor X^{**}$ is surjective.
\end{defi}

\begin{egs}~
  \begin{itemize}
    \item Some reflexive spaces are Hilbert spaces, finite-dimensional spaces, $\ell_p$ and $L_p(\mu)$ for $1 < p < \infty$.
    \item Some non-reflexive spaces are $c_0, \ell_1, \ell_\infty, L_1[0, 1]$.
  \end{itemize}
\end{egs}

\begin{rmks}~
  \begin{itemize}
  \item If $X$ is reflexive, then $X \cong X^{**}$, so $X$ is complete.
  \item There are Banach spaces $X$ such that $X \cong X^{**}$ but $X$ is not reflexive, eg {\bf James' space}. Any isomorphism to the bidual is then necessarily not the canonical embedding.
  \end{itemize}
\end{rmks}

\clearpage
\section{The dual of \texorpdfstring{$L_p(\mu)$ and $C(K)$}{Lp(mu) or C(K)}}

\subsection{Dual operators}

\newlec

Let $X, Y$ be normed spaces. Recall
$$\mathcal B(X, Y) = \{T : X \mor Y | T \text{ linear, bounded}\}$$
This is a normed space in the operator norm:
$$\norm T = \sup_{x \in B_X} \norm{Tx}$$
If $Y$ is complete, then so is $\mathcal B(X, Y)$. For $T \in \mathcal B(X, Y)$, the {\bf dual operator} of $T$ is the map $T^* : Y^* \mor X^*$ given by $T^*g = g \circ T$. In bracket notation $\inn x{T^*g} = \inn{Tx} g$ for $x \in X, g \in Y^*$.

{\bf $T^*$ is linear}
\begin{eqnarray*}
  \inn x {T^*(g + h)}
  & = & \inn{Tx}{g + h} \\
  & = & \inn{Tx}g + \inn{Tx}h \\
  & = & \inn x{T^*g} + \and x{T^* h} \\
  & = & \inn x{T^*g + T^*h}
\end{eqnarray*}
\begin{eqnarray*}
  \inn x {T^*(\lambda g)}
  & = & \inn{Tx}{\lambda g} \\
  & = & \lambda \inn{Tx}g \\
  & = & \lambda \inn x{T^*g} \\
  & = & \inn x{\lambda T^*g}
\end{eqnarray*}

{\bf $T^*$ is bounded}
\begin{eqnarray*}
  \norm{T^*}
  & = & \sup_{g \in B_{Y^*}} \norm{T^*g} \\
  & = & \sup_{g \in B_{Y^*}} \sup_{x \in B_X} \abs{\inn x{T^*g}} \\
  & = & \sup_{x \in B_X} \sup_{g \in B_{Y^*}} \abs{\inn{Tx}g} \\
  & = & \sup_{x \in B_X} \norm{Tx} \text{ by Theorem \ref{thm:hb-support} (ii)} \\
  & = & \norm T
\end{eqnarray*}

\begin{rmks}~
  \begin{itemize}
    \item Hahn-Banach is crucial here. Without it, the dual could be $0$.
    \item $\inn\cdot\cdot$ is linear in both arguments. This contrasts with the Hilbert space case where $\inn\cdot\cdot$ is conjugate-linear in one of the arguments. This comes from the conjugate-linearity of the identification $H^* \cong H$.
    \item If $X, Y$ are Hilbert spaces and we identify $X, Y$ with $X^*, Y^*$, respectively, then $T^*$ is the adjoint of $T$.
  \end{itemize}
\end{rmks}

\begin{eg}
  Let $1 < p, q < \infty$, $p^{-1} + q^{-1} = 1$ and define $R : \ell_p \mor \ell_p$ to be the {\bf right shift operator} $(x_0, x_1, \dots) \mapsto (0, x_0, \dots)$. Then $R^* : \ell_q \mor \ell_q$ is the {\bf left shift operator} $(x_0, x_1, \dots) \mapsto (x_1, x_2, \dots)$.
\end{eg}

Some properties of the dual operator are
\begin{enumerate}
  \item $\id_X^* = \id_{X^*}$
  \item $(S + T)^* + S^* + T^*$, $(\lambda T)^* = \lambda T^*$
  \item $(ST)^* = T^*S^*$
  \item $T \mapsto T^* : \mathcal B(X, Y) \mor \mathcal B(Y^*, X^*)$ is an {\it into} isomorphism.
  \item The double dual of an operator commutes with the double dual embedding. \\
    TODO: Insert commutative diagram
    For all $x$,
    $$\inn g{T^{**}\hat x} = \inn{T^*g}{\hat x} = \inn x{T^*g} = \inn{Tx}g = \inn g{\hat{Tx}}$$
    So $T^{**}\hat x = \widehat{Tx}$.
\end{enumerate}

\begin{rmk}
  From the above properties, if $X \sim Y$, then $X^* \sim Y^*$. Interestingly, if $X$ and $Y$ are reflexive, then we can deduce $X \sim Y$ from $X^* \sim Y^*$.
\end{rmk}

\subsection{Quotient spaces}

Let $X$ be a normed space and $Y$ be a {\it closed} subspace.. Then the quotient space $X / Y$ becomes a normed space in the quotient norm:
$$\norm{x + Y} = d(x, Y) = \inf_{y \in Y} \norm{x + y}$$
The quotient map $q : X \mor X/Y$ is linear and bounded: $\norm{q(x)} \le \norm x$, so $\norm q \le 1$.

$q$ maps the open unit ball $D_X$ onto $D_{X/Y}$. Indeed, if $x \in D_X$, then $\norm{q(x)} \le \norm x < 1$. Reciprocally, if $q(x) \in D_{X/Y}$, then there exists $y \in Y$ such that $\norm{x + y} < 1$. So $x + y \in D_X$ and $q(x + y) = q(x)$. It follows that $q$ is an open map and $\norm q = 1$.

If $Z$ is another normed space, $T \in \mathcal B(X, Z)$ and $Y \subseteq \ker T$, then there exists a unique map $\tilde T$ is linear and $\tilde T(D_{X/Y}) = \tilde T(q(D_X)) = T(D_X)$. It follows that $\norm{\tilde T} = \norm T$.

\begin{thm}
  Let $X$ be a normed space. If $X^*$ is separable, then so is $X$.
\end{thm}
\begin{rmk}
  The converse is false, as $X = \ell_1, X^* = \ell_\infty$ shows.
\end{rmk}
\begin{proof}
  Since $X^*$ is separable, so is $S_{X^*}$. Let $f_n$ be a dense subset of $S_{X^*}$. For every $n$, find $x_n \in B_X$ such that $f_n(x_n) > \frac 12$. Let
  $$Y = \overline{\Span\{x_n | n \in \N\}}$$
  \begin{claim}
    $Y = X$
  \end{claim}
  Then we're done since $Y$ is separable via $Y = \overline{\Span_\Q\{x_n | n \in \N\}}$.
  \begin{proof}
    Assume not. Then we can pick $g \in (X/Y)^*$, $\norm g = 1$ (by Theorem \ref{thm:hb-support} (ii)). Let $f = g \circ q$. Then $\norm f = \norm g = 1$, ie $f \in S_{X^*}$. Thus find $n$ such that $\norm{f - f_n} < \frac 14$, so that
    $$\frac 14 > \norm{f - f_n}\norm{x_n} \ge \abs{(f - f_n)(x_n)} = \abs{f_n(x_n)} > \frac 12$$
    contradiction.
  \end{proof}
\end{proof}

\begin{thm}
  Let $X$ be a separable normed space. Then $X$ embeds isometrically into $\ell_\infty$.
\end{thm}
\begin{proof}
  Let $\{x_n | n \in \N\}$ be dense in $X$. For every $n$, find $f_n \in S_{X^*}$, $f_n(x_n) = \norm{x_n}$ (assuming $X \ne \{0\}$). Define $T : X \mor \ell_\infty$ by $(Tx)_n = f_n(x)$.

  {\bf Well definition}
  $$ \abs{(Tx)_n} = \abs{f_n(x)} \le \norm{f_n}\norm x = \norm x$$
  Hence $\norm{Tx}_\infty \le \norm x < \infty$.

  {\bf Linearity}
  $$ (T(x + y))_n = f_n(x + y) = f_n(x) + f_n(y) = (Tx + Ty)_n$$
  $$ (T(\lambda x))_n = f_n(\lambda x) = \lambda f_n(x)) = (\lambda Tx)_n$$
  so $T(x + y) = Tx + Ty, T(\lambda x) = \lambda Tx$.

  {\bf Isometry} \\
  We already know $\norm{Tx}_\infty \le \norm x$. On the other hand, find $f$ a supporting functional for $x$ and $f_{n_k}$ a subsequence converging to $f$. Then
  $$\norm{Tx}_\infty \ge \sup_k (Tx)_{n_k} = \sup_k \abs{f_{n_k}(x)} \ge \abs{f(x)} = \norm x$$
\end{proof}

\printindex
\end{document}